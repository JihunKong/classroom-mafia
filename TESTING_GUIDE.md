# 🎮 마피아 게임 테스트 가이드

## 구현된 주요 기능

### 1. TTS (Text-to-Speech) 음성 알림 ✅
- **구현 위치**: `client/src/App.tsx` (speak 함수)
- **작동 방식**: Web Speech API 사용
- **음성 알림 시점**:
  - 게임 시작: "게임이 시작되었습니다"
  - 밤 페이즈: "밤이 되었습니다. 마피아는 공격할 대상을 선택하세요"
  - 낮 페이즈: "아침이 밝았습니다"
  - 투표 페이즈: "투표를 시작합니다"
  - 처형 투표: "{이름}을 처형할지 투표하세요"
  - 게임 종료: "게임이 종료되었습니다"

### 2. 마피아 투표 시스템 ✅
- **구현 위치**: `server/src/index.ts` (night:action 핸들러)
- **작동 방식**:
  - 마피아들끼리 실시간으로 투표 현황 공유
  - 과반수가 동일한 대상에 투표하면 그 대상이 사망
  - 투표가 나뉘면 가장 많은 표를 받은 대상이 사망

### 3. 시민 더미 액션 ✅
- **구현 위치**: `client/src/App.tsx` (isDummy 체크)
- **작동 방식**:
  - 시민은 밤에 "다른 플레이어들이 행동 중입니다..." 메시지 표시
  - 2-5초 랜덤 딜레이 후 자동으로 더미 액션 제출
  - 휴대폰 사용으로 역할 추측 방지

### 4. 즉시 페이즈 전환 ✅
- **구현 위치**: `server/src/index.ts` (checkAllActionsSubmitted 함수)
- **작동 방식**:
  - 모든 생존 플레이어가 행동 완료 시 타이머 무시하고 즉시 다음 페이즈로
  - 게임 진행 속도 향상

## 수동 테스트 방법

### 1. 최소 인원 테스트 (6명)
```bash
# 1. 서버와 클라이언트 실행
npm run dev

# 2. 브라우저에서 6개 탭 열기
# 3. 각 탭에서 localhost:5173 접속
# 4. 첫 번째 탭에서 방 만들기
# 5. 나머지 탭에서 방 코드로 참여
```

**확인 사항**:
- [ ] TTS로 "게임이 시작되었습니다" 음성 재생
- [ ] 밤에 시민들이 자동으로 더미 액션 제출
- [ ] 마피아 1명이 대상 선택
- [ ] 모든 행동 완료 시 즉시 낮으로 전환

### 2. 중간 인원 테스트 (10-12명)
**역할 구성**: 마피아 2명, 의사 1명, 경찰 1명, 시민 6-8명

**확인 사항**:
- [ ] 마피아 2명이 각자 투표
- [ ] 투표 현황이 실시간으로 공유됨
- [ ] 과반수 투표로 대상 결정
- [ ] 의사와 경찰이 각자 행동

### 3. 최대 인원 테스트 (20명)
**역할 구성**: 마피아팀 6명 (보스, 마피아 3명, 마담, 스파이), 특수역할 다수

**확인 사항**:
- [ ] 20명 모두 접속 가능
- [ ] 복잡한 역할 구성에서도 게임 진행
- [ ] 모든 특수 능력 작동

## 브라우저 개발자 도구로 확인

### 1. TTS 작동 확인
```javascript
// 콘솔에서 직접 테스트
window.speechSynthesis.speak(new SpeechSynthesisUtterance('테스트'))
```

### 2. Socket 이벤트 확인
- Network 탭 > WS > Messages에서 실시간 통신 확인
- `night:action`, `night:voteUpdate` 이벤트 확인

### 3. 더미 액션 타이밍
- 시민 플레이어의 콘솔에서 자동 제출 로그 확인

## 인원수별 역할 분배

| 인원 | 마피아팀 | 의사 | 경찰 | 특수 | 시민 |
|------|----------|------|------|------|------|
| 6명  | 1        | 1    | 0    | 0    | 4    |
| 8명  | 2        | 1    | 1    | 0    | 4    |
| 10명 | 2        | 1    | 1    | 1    | 5    |
| 12명 | 3        | 1    | 1    | 2    | 5    |
| 15명 | 4        | 1    | 1    | 3    | 6    |
| 20명 | 6        | 1    | 2    | 4    | 7    |

## 디버깅 팁

1. **TTS가 작동하지 않는 경우**:
   - 브라우저 권한 설정 확인
   - 음소거 해제 확인
   - Chrome/Edge 권장

2. **마피아 투표가 동기화되지 않는 경우**:
   - Socket 연결 상태 확인
   - 서버 로그에서 `night:voteUpdate` 이벤트 확인

3. **더미 액션이 제출되지 않는 경우**:
   - 플레이어 역할이 시민인지 확인
   - 콘솔에서 타임아웃 에러 확인

## 성능 테스트

20명 동시 접속 시:
- CPU 사용률 모니터링
- 메모리 사용량 확인
- Socket.io 연결 안정성
- 페이즈 전환 지연 시간

## 추가 구현 가능 기능

1. 채팅 기능 (낮 토론용)
2. 음향 효과 추가
3. 역할별 특수 UI
4. 게임 통계 및 로그 저장